/*
Get forms with members 

*/

 SELECT
      OBJ0.OBJECT_ID FRM_ID 
	, OBJ0.OBJECT_NAME AS FRM_NAME 
    , OBJ2.OBJECT_ID DIM_ID 
	, OBJ2.OBJECT_NAME AS DIM_NAME
	, LAYOUT_TYPE LAYOUT_ORDER 
    , decode(LAYOUT_TYPE
          ,0, 'POV'
          ,1, 'Page'
          ,2, 'Row'
          ,3, 'Col')  LAYOUT
    , LAYT.ordinal orders	
	, DECODE(DEF_MBR.SUBST_VAR,NULL,OBJ1.OBJECT_NAME,'&'||DEF_MBR.SUBST_VAR)  AS Member  
	, DEF_MBR.QUERY_TYPE
    , FRM_DEF.LOCATION  
    , decode(LAYOUT_TYPE ,2, '99',LAYOUT_TYPE)||FRM_DEF.LOCATION|| LAYT.ordinal ||QUERY_TYPE SORT_ORDER 
FROM  HSP_OBJECT OBJ0  
	LEFT JOIN HSP_FORMOBJ_DEF  FRM_DEF ON  1=1 
		AND OBJ0.OBJECT_ID = FRM_DEF.FORM_ID 

	LEFT JOIN  HSP_FORMOBJ_DEF_MBR DEF_MBR on 1=1 
	    AND DEF_MBR.OBJDEF_ID = FRM_DEF.OBJDEF_ID
		
	LEFT JOIN HSP_MEMBER MBR on 1=1 
		AND MBR.MEMBER_ID = DEF_MBR.MBR_ID		

	LEFT JOIN HSP_OBJECT OBJ2 on 1=1 
		AND OBJ2.OBJECT_ID = MBR.DIM_ID   

	LEFT JOIN HSP_OBJECT OBJ1 on 1=1 
		AND OBJ1.OBJECT_ID = MBR.MEMBER_ID   
    
	LEFT JOIN HSP_FORM_LAYOUT LAYT on 1=1 
		AND OBJ0.OBJECT_ID = LAYT.form_id
		AND MBR.DIM_ID = LAYT.dim_id
 
WHERE  1=1 
 
  AND OBJ0.OBJECT_TYPE=7
  -- AND OBJ2.OBJECT_NAME = DECODE(DEF_MBR.SUBST_VAR,NULL,OBJ1.OBJECT_NAME,'&'||DEF_MBR.SUBST_VAR)
  order by sort_order 
